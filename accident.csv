import pandas as pd

# Load dataset
df = pd.read_csv('accidents.csv')

# Quick look
print(df.head())
print(df.info())
print(df.describe())
# Handle missing data
df = df.dropna(subset=['Weather', 'Road_Condition', 'Latitude', 'Longitude'])

# Convert date & time
df['Date'] = pd.to_datetime(df['Date'])
df['Hour'] = pd.to_datetime(df['Time'], format='%H:%M').dt.hour
df['DayOfWeek'] = df['Date'].dt.day_name()
import matplotlib.pyplot as plt

plt.figure(figsize=(8,5))
df['Hour'].value_counts().sort_index().plot(kind='bar')
plt.title('Accidents by Hour of Day')
plt.xlabel('Hour')
plt.ylabel('Number of Accidents')
plt.show()
df['Weather'].value_counts().plot(kind='bar', color='skyblue')
plt.title('Accidents by Weather Condition')
plt.show()
df['Road_Condition'].value_counts().plot(kind='bar', color='orange')
plt.title('Accidents by Road Condition')
plt.show()
import folium
from folium.plugins import HeatMap

# Create base map
m = folium.Map(location=[df['Latitude'].mean(), df['Longitude'].mean()], zoom_start=10)

# Add heatmap
HeatMap(df[['Latitude', 'Longitude']].values, radius=10).add_to(m)

# Save map
m.save('accident_hotspots.html')
severity_by_weather = df.groupby('Weather')['Severity'].mean().sort_values(ascending=False)
severity_by_road = df.groupby('Road_Condition')['Severity'].mean().sort_values(ascending=False)

print(severity_by_weather)
print(severity_by_road)
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.preprocessing import LabelEncoder

le = LabelEncoder()
for col in ['Weather', 'Road_Condition', 'DayOfWeek']:
    df[col] = le.fit_transform(df[col])

X = df[['Weather', 'Road_Condition', 'Hour']]
y = df['Severity']

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

model = RandomForestClassifier()
model.fit(X_train, y_train)

print("Model Accuracy:", model.score(X_test, y_test))

